<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.
css"
      rel="stylesheet"
    />
    <!-- favicon en pestaña -->
    <link
      rel="icon"
      type="image/x-icon"
      href="{{ url_for('static', filename='icoon.png') }}"
    />
    <!-- titulo en pestaña -->
    <title>Mapa de emprendedoras</title>
    <style>
      body::-webkit-scrollbar {
        display: none;
      }

      /* esconder scroll de la web */
      body {
        -ms-overflow-style: none; /* IE and Edge */
        scrollbar-width: none; /* Firefox */
      }
    </style>
  </head>
  <body class="overflow-x-hidden">
    <!-- Barra e icons -->
    <header class="sticky top-0 z-30 w-full"></header>

    <!-- Mensaje principal---- -->

    <div class="bg-white" id="denuncia">
      <div class="max-w-7xl mx-auto py-16 px-4 sm:py-24 sm:px-6 lg:px-8">
        <div class="text-center">
          <h2
            class="text-base font-semibold text-violet-400 tracking-wide uppercase"
          ></h2>
          <p
            class="mt-1 text-4xl font-extrabold text-purple-800 sm:text-5xl sm:tracking-tight lg:text-6xl"
          >
            Alianzas
          </p>
          <p class="max-w-xl mt-5 mx-auto text-xl text-gray-500">
            Este espacio esta diseñado para vos! Para encontrarnos entre
            emprendedoras y crecer juntas
          </p>
        </div>
      </div>
    </div>
    <div class="px-36">
      <form class="grid grid-cols-3">
        <!-- Primera parte formulario---- -->

        <div
          class="relative border border-gray-300 rounded-md px-3 py-2 shadow-sm focus-within:ring-1 focus-within:ring-indigo-600 focus-within:border-indigo-600 w-60"
        >
          <label
            for="categoria"
            class="absolute -top-2 left-2 -mt-px inline-block px-1 bg-white text-xs font-medium text-blue-900"
            >Listado de Rubros</label
          >
          <select name="categoria" id="categoria">
            <option value="Belleza">Belleza</option>
            <option value="Gastronomía">Gastronomía</option>
            <option value="Artesanías">Artesanías</option>
            <option value="Prendas de vestir">Prendas de vestir</option>
            <option value="Cuidado de ancianos">Cuidado de ancianos</option>
            <option value="Educación">Educación</option>
            <option value="Trabajo doméstico">Trabajo doméstico</option>
            <option value="Cuidado de niños">Cuidado de niños</option>
          </select>
          <!-- <input type="text" name="categoria" id="categoria" class="block w-full border-0 p-0 text-gray-900 placeholder-gray-500 focus:ring-0 sm:text-sm" placeholder="Ejemplo: Bache con agua"> -->
        </div>

        <div
          class="relative border border-gray-300 rounded-md px-3 py-2 shadow-sm focus-within:ring-1 focus-within:ring-indigo-600 focus-within:border-indigo-600 w-60"
        >
          <label
            for="categoria"
            class="absolute -top-2 left-2 -mt-px inline-block px-1 bg-white text-xs font-medium text-blue-900"
            >Distancia de emprendimientos cercanos</label
          >
          <select name="categoria" id="categoria">
            <option value="1km">1km</option>
            <option value="5km">5km</option>
            <option value="10km">10km</option>
            <option value="15km">15km</option>
            <option value="20km">20km</option>
          </select>
          <!-- <input type="text" name="categoria" id="categoria" class="block w-full border-0 p-0 text-gray-900 placeholder-gray-500 focus:ring-0 sm:text-sm" placeholder="Ejemplo: Bache con agua"> -->
        </div>

        <!-- boton Guardar -->

        <button
          type="submit"
          class="inline-flex items-center px-3 py-2 border border-transparent text-center font-medium rounded-md shadow-sm text-white bg-purple-700 hover:bg-purple-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 w-60 content-center"
        >
          Historial de alianzas
        </button>
      </form>

      <!-- mapa de ubicaciones -->

      <div class="bg-white" id="mapa">
        <div class="max-w-7xl mx-auto py-16 px-4 sm:py-24 sm:px-6 lg:px-8">
          <div class="text-center">
            <h2
              class="text-base font-semibold text-purple-300 tracking-wide uppercase"
            ></h2>
            <p
              class="mt-1 text-4xl font-extrabold text-purple-600 sm:text-5xl sm:tracking-tight lg:text-6xl"
            >
              Mapa de emprendedoras:
            </p>
            <p class="max-w-xl mt-5 mx-auto text-xl text-gray-500">
              Unidas podemos hacer mas!.
            </p>
            <iframe
              src="/map"
              width="600"
              height="450"
              style="border: 0"
              allowfullscreen=""
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"
            ></iframe>
          </div>
        </div>
      </div>
    </div>

    <script>
      let DB = [];
      let uuid = Math.random().toString();
      var ubi = [];
      let listOfMarkers = [];

      loadPositions();

      if ("geolocation" in navigator) {
        console.log("location is available");
        searchPosition();
      } else {
        console.log("geolocation is not available");
      }

      async function loadPositions() {
        const response = await fetch("/nueva");
        const locations = await response.json();

        listOfMarkers.forEach(removeMarker);
        function removeMarker(marker) {
          map.removeLayer(marker);
        }

        listOfMarkers = [];
      }

      function searchPosition() {
        navigator.geolocation.getCurrentPosition(async (position) => {
          var lat = position.coords.latitude;
          var lon = position.coords.longitude;
          document.getElementById("latitud").value = lat;
          document.getElementById("longitud").value = lon;
          const data = { uuid, lat, lon };
          const options = {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(data),
          };
          fetch("/nueva", options);
        });
      }
    </script>
  </body>
</html>
